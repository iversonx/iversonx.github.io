<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>模版方法模式(Template Method) | IVERSON X BLOG</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">模版方法模式(Template Method)</h1><a id="logo" href="/.">IVERSON X BLOG</a><p class="description">Iverson x's personal blog</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">模版方法模式(Template Method)</h1><div class="post-meta">2018-11-30<span> | </span><span class="category"><a href="/categories/design-pattern/">设计模式</a></span></div><div class="post-content"><h2 id="一、什么是模版方法模式"><a href="#一、什么是模版方法模式" class="headerlink" title="一、什么是模版方法模式"></a>一、什么是模版方法模式</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>定义一个操作中的算法的骨架，将一些步骤延迟到子类中。模版方法使子类可以不改变一个算法的结构即可重定义该算法的某些特定步骤。</p>
<h3 id="结构说明"><a href="#结构说明" class="headerlink" title="结构说明"></a>结构说明</h3><p>[结构示例图]</p>
<ul>
<li>AbstractClass：抽象类，定义算法骨架和原语操作，具体的子类通过重定义这些原语操作来实现一个算法的各个步骤。</li>
<li>ConcreteClass：具体实现类，实现算法骨架中的某些步骤，完成与特定子类相关的功能。</li>
</ul>
<h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="comment">// 原语操作</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doPrimitiveOperation1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="comment">// 原语操作2</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="keyword">void</span> <span class="title">doPrimitiveOperation2</span><span class="params">()</span></span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 模版方法，定义算法骨架</span></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">final</span> <span class="keyword">void</span> <span class="title">templateMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        doPrimitiveOperation1();</span><br><span class="line">        doPrimitiveOperation2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteClass</span> <span class="keyword">extends</span> <span class="title">AbstractClass</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPrimitiveOperation1</span><span class="params">()</span></span>&#123;</span><br><span class="line">        <span class="comment">// 具体实现</span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">doPrimitiveOperation2</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 具体实现</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、模版方法模式讲解"><a href="#二、模版方法模式讲解" class="headerlink" title="二、模版方法模式讲解"></a>二、模版方法模式讲解</h2><h3 id="模板方法模式的功能"><a href="#模板方法模式的功能" class="headerlink" title="模板方法模式的功能"></a>模板方法模式的功能</h3><p>模板方法模式的功能在于固定算法骨架，而让具体算法实现可扩展。</p>
<p>模板方法模式还可以控制子类的扩展。因为在父类中定义好了算法的步骤，只是在某几个固定的点才会调用到被子类实现的方法。</p>
<h3 id="变与不变"><a href="#变与不变" class="headerlink" title="变与不变"></a>变与不变</h3><p>程序设计的一个重要的思考点就是“变与不变”：分析程序中哪些功能是可变的，哪些功能是不变的，然后把不变的部分抽象出来，进行公共的实现，把变化部分分离出去，用接口封装隔离，或者用抽象类约束子类行为。</p>
<p>模板方法实现的就是不变的方法和算法的骨架，而变化的地方，通过抽象方法，把具体的时候延迟到子类中。</p>
<h3 id="好莱坞法则"><a href="#好莱坞法则" class="headerlink" title="好莱坞法则"></a>好莱坞法则</h3><p>好莱坞法则就是”不要找我们，我们会联系你”。</p>
<p>模版方法模式很好地体现这一点，作为父类的模版会在需要的时候，调用子类相应的方法，也就是由父类来找子类。这是一种反向的控制结构。通常是子类找父类，因为父类根本就不知道子类。</p>
<p>Java里面实现这样功能的理论依据在于Java的动态绑定用的是“后期版定”技术，对于出现子类覆盖父类方法的情况，在编译时是看数据类型，运行时则看实际的对象类型(new 操作符跟的构造方法是哪个类，new 谁就调用谁的方法)。</p>
<p>因此在使用模版方法模式的时候，虽然用的数据类型是模版类型，但是在创建类实例时，是创建具体的子类实例，在调用的时候，会被动态绑定到子类的方法上，从而实现反向控制。</p>
<h3 id="模板的写法"><a href="#模板的写法" class="headerlink" title="模板的写法"></a>模板的写法</h3><p>通常在模板里包含以下操作类型：</p>
<ul>
<li><p>模板方法：定义算法骨架的方法。</p>
</li>
<li><p>具体的操作：在模板直接实现某些步骤的方法。通常这些步骤的实现算法是固定的，而且是不怎么变化的，因此可以将其当作公共功能实现在模板中。</p>
</li>
<li><p>具体的AbstractClass操作：在模板中实现某些公共功能，可以提供给子类使用，一般不是具体的算法步骤的实现，而是一些辅助的公共功能。</p>
</li>
<li><p>原语操作：就是在模板中定义的抽象操作，通常是模板需要调用的操作，是必须的操作，需要子类实现。</p>
</li>
<li><p>钩子操作：在模板中定义，并提供默认实现的操作。这些方法通常被视为可扩展的点，但不是必须的，子类可以有选择地覆盖这些方法，以提供新的实现来扩展功能。</p>
</li>
<li><p>Factory Method：</p>
</li>
</ul>
<h3 id="模版方法模式的优缺点"><a href="#模版方法模式的优缺点" class="headerlink" title="模版方法模式的优缺点"></a>模版方法模式的优缺点</h3><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><p> 通过父类的定义来约束子类的行为，从而使系统能有更好的复用性和扩展性。</p>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><p> 算法骨架不容易升级，如果要对模板中的算法骨架进行变更，可能就会要求所有相关的子类进行相应的变化。</p>
<h3 id="什么时候选用模版方法模式"><a href="#什么时候选用模版方法模式" class="headerlink" title="什么时候选用模版方法模式"></a>什么时候选用模版方法模式</h3><ol>
<li>需要固定定义算法骨架，实现一个算法的不变部分，把可变部分留给子类实现的情况，可以使用模板方法模式</li>
<li>各个子类中具有公共行为，应该抽取出来，集中在一个公共类中去实现，从未避免代码重复。</li>
<li>需要控制子类扩展的情况。模板方法模式会在特定的点来调用子类的方法，这样只运行在这些点进行扩展。</li>
</ol>
<h4 id="五、相关模式"><a href="#五、相关模式" class="headerlink" title="五、相关模式"></a>五、相关模式</h4></div><div class="tags"><a href="/tags/学习笔记/">学习笔记</a></div><div class="post-nav"><a class="next" href="/design-pattern/command.html">命令模式(Command)</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/design-pattern/">设计模式</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/学习笔记/" style="font-size: 15px;">学习笔记</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/design-pattern/template-method.html">模版方法模式(Template Method)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/command.html">命令模式(Command)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/iterator.html">迭代器模式(Iterator)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/mediator.html">中介者模式(Mediator)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/observer.html">观察者模式(Observer)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/composite.html">组合模式(Composite)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/decorator.html">装饰模式(Decorator)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/factory_method.html">工厂方法模式(Factory Method)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/singleton.html">单例模式(Singleton)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/facade.html">外观模式(Facade)</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">IVERSON X BLOG.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>