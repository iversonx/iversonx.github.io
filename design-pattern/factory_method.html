<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.8.0"><meta http-equiv="content-type" content="text/html; charset=utf-8"><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0" name="viewport"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style"><meta content="telephone=no" name="format-detection"><meta name="description"><title>工厂方法模式(Factory Method) | IVERSON X BLOG</title><link rel="stylesheet" type="text/css" href="/css/style.css?v=0.0.0"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/normalize/8.0.1/normalize.min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/pure-min.css"><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/pure/1.0.0/grids-responsive-min.css"><link rel="stylesheet" href="//lib.baomitu.com/font-awesome/4.7.0/css/font-awesome.min.css"><script type="text/javascript" src="//lib.baomitu.com/jquery/3.3.1/jquery.min.js"></script><link rel="icon" mask="" sizes="any" href="/favicon.ico"><link rel="Shortcut Icon" type="image/x-icon" href="/favicon.ico"><link rel="apple-touch-icon" href="/apple-touch-icon.png"><link rel="apple-touch-icon-precomposed" href="/apple-touch-icon.png"></head><body><div class="body_container"><div id="header"><div class="site-name"><h1 class="hidden">工厂方法模式(Factory Method)</h1><a id="logo" href="/.">IVERSON X BLOG</a><p class="description">Iverson x's personal blog</p></div><div id="nav-menu"><a class="current" href="/."><i class="fa fa-home"> 首页</i></a><a href="/archives/"><i class="fa fa-archive"> 归档</i></a><a href="/about/"><i class="fa fa-user"> 关于</i></a></div></div><div class="pure-g" id="layout"><div class="pure-u-1 pure-u-md-3-4"><div class="content_container"><div class="post"><h1 class="post-title">工厂方法模式(Factory Method)</h1><div class="post-meta">2018-11-28<span> | </span><span class="category"><a href="/categories/design-pattern/">设计模式</a></span></div><div class="post-content"><h2 id="一、什么是工厂方法模式"><a href="#一、什么是工厂方法模式" class="headerlink" title="一、什么是工厂方法模式"></a>一、什么是工厂方法模式</h2><h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>定义一个用于创建对象的接口，让接口的子类决定实例化哪个具体类，Factory Method 使一个类的实例化延迟到接口子类中完成。</p>
<h3 id="结构和说明"><a href="#结构和说明" class="headerlink" title="结构和说明"></a>结构和说明</h3><p>[示意图]</p>
<ul>
<li><p>Product：定义工厂方法所创建的对象的接口，即实际需要使用的对象的接口。</p>
</li>
<li><p>Concreteproduct：具体的Product接口的实现对象。</p>
</li>
<li><p>Creator：创建器，声明工厂方法，工厂方法通常会返回一个Product类型的实例对象，通常是抽象方法。</p>
</li>
<li><p>ConcreteCreator：具体的创建器对象，返回具体的Product实例。</p>
</li>
</ul>
<h3 id="示例代码"><a href="#示例代码" class="headerlink" title="示例代码"></a>示例代码</h3><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteProduct</span> <span class="keyword">implements</span> <span class="title">Product</span> </span>&#123;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">abstract</span> <span class="class"><span class="keyword">class</span> <span class="title">Creator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> Product <span class="title">factoryMethod</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">someOperation</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 其他操作，</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">ConcreteCreator</span> <span class="keyword">extends</span> <span class="title">Creator</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> Product <span class="title">factoryMethod</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> ConcreteProduct();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h2 id="二、工厂方法的一些细节"><a href="#二、工厂方法的一些细节" class="headerlink" title="二、工厂方法的一些细节"></a>二、工厂方法的一些细节</h2><h3 id="工厂方法模式的功能"><a href="#工厂方法模式的功能" class="headerlink" title="工厂方法模式的功能"></a>工厂方法模式的功能</h3><p>工厂方法模式的主要功能是让父类在不知道具体实现的情况下，完成自身的功能调用；而具体的实现延迟到子类来实现。</p>
<h3 id="工厂方法的实现"><a href="#工厂方法的实现" class="headerlink" title="工厂方法的实现"></a>工厂方法的实现</h3><h4 id="实现成抽象类"><a href="#实现成抽象类" class="headerlink" title="实现成抽象类"></a>实现成抽象类</h4><p>工厂方法的实现中，通常父类会是一个抽象类，里面包含创建所需对象的抽象方法，这些抽象方法就是工厂方法。</p>
<blockquote>
<p>子类在实现抽象方法时，通常并不是由子类来实现具体的功能，而是在子类的方法中选择具体的具体产品实现对象。</p>
</blockquote>
<h4 id="实现成具体类"><a href="#实现成具体类" class="headerlink" title="实现成具体类"></a>实现成具体类</h4><p>也可以把工厂方法的父类实现成一个具体的类。这种情况下，通常是在父类中提供获取所需对象的默认实现方法，这样即使没有具体的子类，也能够运行。</p>
<h3 id="谁来使用工厂方法创建的对象"><a href="#谁来使用工厂方法创建的对象" class="headerlink" title="谁来使用工厂方法创建的对象"></a>谁来使用工厂方法创建的对象</h3><p>在工厂方法模式里面，应该是Creator中的其他地方在使用工厂方法创建的对象，也可以把工厂方法创建的对象直接提供给Creator外部使用，但工厂方法模式的本意，是前者。</p>
<h3 id="工厂方法模式与Ioc-DI的关系"><a href="#工厂方法模式与Ioc-DI的关系" class="headerlink" title="工厂方法模式与Ioc/DI的关系"></a>工厂方法模式与Ioc/DI的关系</h3><p>从思想层面上，会发现工厂方法模式和Ioc/DI的思想是相似的，都是“主动变被动”进行了“主从换位”，从而获得了更灵活的程序结构。</p>
<p>IoC/DI示例代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> C c = <span class="keyword">null</span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">set</span><span class="params">(C c)</span> </span>&#123;</span><br><span class="line">        <span class="keyword">this</span>.c = c;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 这里需要使用c，可是又不主动创建C</span></span><br><span class="line">        <span class="comment">// 需要外部注入，自己只管使用就好了。</span></span><br><span class="line">        c.tc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">interface</span> <span class="title">C</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">tc</span><span class="params">()</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>工厂方法示例代码</p>
<figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">public</span> <span class="keyword">abstract</span> class <span class="title">A1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">abstract</span> C1 <span class="title">createC1</span><span class="params">()</span></span>;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">t1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="comment">// 这里需要使用C1，也不主动创建C1</span></span><br><span class="line">        <span class="comment">// 延迟到子类里面实现</span></span><br><span class="line">        C1 c = createC1();</span><br><span class="line">        c.tc();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="class"><span class="keyword">class</span> <span class="title">A2</span> <span class="keyword">extends</span> <span class="title">A1</span> </span>&#123;</span><br><span class="line">    <span class="function"><span class="keyword">protected</span> C1 <span class="title">createC1</span><span class="params">()</span> </span>&#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="keyword">new</span> C2();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<h3 id="工厂方法模式的优缺点"><a href="#工厂方法模式的优缺点" class="headerlink" title="工厂方法模式的优缺点"></a>工厂方法模式的优缺点</h3><h4 id="优点"><a href="#优点" class="headerlink" title="优点"></a>优点</h4><ul>
<li><p>可以在不知道具体实现的情况下编程</p>
<p>工厂方法模式可以让你在实现功能的时候，如果需要某个产品对象，只需要使用产品接口即可，而无需关心具体的实现。选择具体实现的人延迟到子类去完成。</p>
</li>
<li><p>更容易扩展对象的新版本</p>
<p>工厂方法为子类提供了一个挂钩，使得扩展新的对象版本变得容易。只要新加入一个子类来提供新的工厂方法实现，然后在客户端使用这个新的子类即可。</p>
</li>
</ul>
<h4 id="缺点"><a href="#缺点" class="headerlink" title="缺点"></a>缺点</h4><ul>
<li><p>具体产品对象和工厂方法的耦合性</p>
<p>在工厂方法模式中，工厂方法需要选择具体的产品对象，并创建它们的实例，因此具体产品对象和工厂方法是耦合的。</p>
</li>
</ul>
<h3 id="何时选用工厂方法模式"><a href="#何时选用工厂方法模式" class="headerlink" title="何时选用工厂方法模式"></a>何时选用工厂方法模式</h3><ul>
<li><p>如果一个类需要创建某个接口的对象，但是又不知道具体的实现，这种请求可以选用工厂方法模式，把创建对象的工作延迟到子类中去实现。</p>
</li>
<li><p>如果一个类本身就希望由它的子类来创建所需的对象的时候，可以使用工厂方法模式。</p>
</li>
</ul>
<h3 id="相关模式"><a href="#相关模式" class="headerlink" title="相关模式"></a>相关模式</h3><ul>
<li><p>工厂方法模式和模板方法模式</p>
<p>这两个模式外观类似，都有个抽象类，然后由子类提供实现。工厂方法模式专注的是创建产品对象，而模版方法模式专注的为固定的算法骨架提供某些步骤的实现。</p>
</li>
</ul>
</div><div class="tags"><a href="/tags/学习笔记/">学习笔记</a></div><div class="post-nav"><a class="pre" href="/design-pattern/decorator.html">装饰模式(Decorator)</a><a class="next" href="/design-pattern/singleton.html">单例模式(Singleton)</a></div></div></div></div><div class="pure-u-1-4 hidden_mid_and_down"><div id="sidebar"><div class="widget"><form class="search-form" action="//www.google.com/search" method="get" accept-charset="utf-8" target="_blank"><input type="text" name="q" maxlength="20" placeholder="Search"><input type="hidden" name="sitesearch" value="http://yoursite.com"></form></div><div class="widget"><div class="widget-title"><i class="fa fa-folder-o"> 分类</i></div><ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/design-pattern/">设计模式</a></li></ul></div><div class="widget"><div class="widget-title"><i class="fa fa-star-o"> 标签</i></div><div class="tagcloud"><a href="/tags/学习笔记/" style="font-size: 15px;">学习笔记</a></div></div><div class="widget"><div class="widget-title"><i class="fa fa-file-o"> 最近文章</i></div><ul class="post-list"><li class="post-list-item"><a class="post-list-link" href="/design-pattern/template-method.html">模版方法模式(Template Method)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/command.html">命令模式(Command)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/iterator.html">迭代器模式(Iterator)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/mediator.html">中介者模式(Mediator)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/observer.html">观察者模式(Observer)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/composite.html">组合模式(Composite)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/decorator.html">装饰模式(Decorator)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/factory_method.html">工厂方法模式(Factory Method)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/singleton.html">单例模式(Singleton)</a></li><li class="post-list-item"><a class="post-list-link" href="/design-pattern/facade.html">外观模式(Facade)</a></li></ul></div></div></div><div class="pure-u-1 pure-u-md-3-4"><div id="footer">Copyright © 2018 <a href="/." rel="nofollow">IVERSON X BLOG.</a> Powered by<a rel="nofollow" target="_blank" href="https://hexo.io"> Hexo.</a><a rel="nofollow" target="_blank" href="https://github.com/tufu9441/maupassant-hexo"> Theme</a> by<a rel="nofollow" target="_blank" href="https://github.com/pagecho"> Cho.</a></div></div></div><a class="show" id="rocket" href="#top"></a><script type="text/javascript" src="/js/totop.js?v=0.0.0" async></script><script type="text/javascript" src="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.js" async></script><script type="text/javascript" src="/js/fancybox.js?v=0.0.0" async></script><link rel="stylesheet" type="text/css" href="//lib.baomitu.com/fancybox/3.5.2/jquery.fancybox.min.css"><script type="text/javascript" src="/js/codeblock-resizer.js?v=0.0.0"></script><script type="text/javascript" src="/js/smartresize.js?v=0.0.0"></script></div></body></html>